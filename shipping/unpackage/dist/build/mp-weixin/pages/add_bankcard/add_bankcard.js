(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/add_bankcard/add_bankcard"],{"0ca7":function(a,e,t){"use strict";(function(a){t("c5c7");n(t("66fd"));var e=n(t("af03"));function n(a){return a&&a.__esModule?a:{default:a}}a(e.default)}).call(this,t("543d")["createPage"])},"1d59":function(a,e,t){"use strict";(function(a){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=r(t("a34a"));function r(a){return a&&a.__esModule?a:{default:a}}function i(a,e,t,n,r,i,c){try{var s=a[i](c),u=s.value}catch(o){return void t(o)}s.done?e(u):Promise.resolve(u).then(n,r)}function c(a){return function(){var e=this,t=arguments;return new Promise((function(n,r){var c=a.apply(e,t);function s(a){i(c,n,r,s,u,"next",a)}function u(a){i(c,n,r,s,u,"throw",a)}s(void 0)}))}}var s=function(){Promise.all([t.e("common/vendor"),t.e("node-modules/vue-multiselect/src/Multiselect")]).then(function(){return resolve(t("c1d3"))}.bind(null,t)).catch(t.oe)},u={data:function(){return{isPerson:!1,disabled:!0,active:!1,queryParams:{pageNum:1,pageSize:10},bank_name:"",bank_placeholder:"请输入银行名称",branch_name:"",branch_placeholder:"请输入支行联行名称",bankcardAccount:"",params:{},remark:"",received_info:[],bank_list:[],bank_class_index:0,account_type_index:0,account_type_list:["请选择账号类型","个人","企业"],default_list:["请选择是否默认账户","是","否"],fullNameOfTheBank:"",default_account_index:0,array:[],index:0,list_code:[],list_name:[],branch_list:[],branch_code_list:[],branch_index:0,btn_title:"",value:null,branch_value:null,bank_options:[],branch_options:[]}},components:{Multiselect:s},onLoad:function(e){this.btn_title=e.btn_title,"修改"==this.btn_title&&(this.received_info=a.getStorageSync("bankcard_item"),this.bankcardAccount=this.received_info.bankcardAccount,this.default_account_index=this.received_info.carrierBankcardIsDefault,this.remark=this.received_info.remark,this.bank_placeholder=this.received_info.bankName,this.branch_placeholder=this.received_info.branchBankName),console.log(this.received_info,"777")},created:function(){"修改"==this.btn_title&&(this.account_type_index=this.received_info.carrierAccountType,this.disabled=!1,this.active=!0),this.getBankName()},mounted:function(){a.setNavigationBarTitle({title:"".concat(this.btn_title,"承运人银行卡")})},methods:{getBank:function(a){this.bank_name=a.dictLabel,this.params.bankCode=a.dictValue,this.params.bankName=a.dictLabel,this.fullNameOfTheBank=this.bank_name,this.branch_value=null,this.getBranchNameNew()},getBranch:function(a){this.branch_name=a.fullNameOfTheBank,this.params.branchBankNo=a.paymentBankNumber,this.params.branchBankName=a.fullNameOfTheBank},bindBankClassPickerChange:function(a){console.log("picker发送选择改变，携带值为",a.target.value),this.bank_class_index=a.target.value,this.params.carrierBankcardCategory=1},bindAccountTypePickerChange:function(a){console.log("picker发送选择改变01，携带值为",a.target.value),this.account_type_index=a.target.value,0==a.target.value||(1==a.target.value?this.params.carrierAccountType=1:2==a.target.value&&(this.params.carrierAccountType=2))},bindPickerDefaultAccountChange:function(a){console.log("picker发送选择改变，携带值为Default",a.target.value),this.default_account_index=a.target.value,this.params.carrierBankcardIsDefault=a.target.value,this.disabled=!1,this.active=!0},getBankName:function(){var a=this;return c(n.default.mark((function e(){var t,r,i;return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a.$getRegistDicts("bank_code");case 2:return t=e.sent,a.array=t.data.data.map((function(a){return a.dictLabel})),a.bank_options=t.data.data,a.array.unshift("请选择银行名称"),a.list_code=t.data.data.map((function(a){return a.dictValue})),"修改"==a.btn_title&&(r=a.received_info.bankName,a.index=a.array.findIndex((function(a){return a==r})),a.getBranchNameNew()),e.next=10,a.$getRegistDicts("carrier_bankcard_category");case 10:i=e.sent,a.bank_list=i.data.data.map((function(a){return a.dictLabel}));case 12:case"end":return e.stop()}}),e)})))()},getBranchNameNew:function(){var e=this;return c(n.default.mark((function t(){var r,i,c;return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=a.getStorageSync("token"),e.queryParams,"修改"==e.btn_title?i=e.received_info.bankName:"添加"==e.btn_title&&(i=e.fullNameOfTheBank),t.next=5,e.$request({url:"/iscm/bankBranchList/likeByFullNameOfTheBank?fullNameOfTheBank="+i,method:"GET",header:{Authorization:r}});case 5:c=t.sent,e.branch_options=c.data.rows,e.branch_list=c.data.rows.map((function(a){return a.fullNameOfTheBank})),e.branch_code_list=c.data.rows.map((function(a){return a.paymentBankNumber})),e.branch_list.unshift("请选择支行联行名称"),"修改"==e.btn_title&&e.bindPickerBranchChange();case 11:case"end":return t.stop()}}),t)})))()},bindPickerChange:function(a){console.log("picker发送选择改变，携带值为bank",a.target.value),this.index=a.target.value,this.params.bankCode=this.list_code[this.index-1],this.params.bankName=this.array[this.index],this.fullNameOfTheBank=this.array[this.index],this.getBranchName()},bindPickerBranchChange:function(a){if("修改"==this.btn_title){var e=this.received_info.branchBankName;this.branch_index=this.branch_list.findIndex((function(a){return a==e}))}else"添加"==this.btn_title&&(console.log("picker发送选择改变，携带值为branch",a.target.value),this.branch_index=a.target.value,this.params.branchBankName=this.branch_list[this.branch_index],this.params.branchBankNo=this.branch_code_list[this.branch_index-1],this.params.branchBankNo=parseInt(this.params.branchBankNo))},getBankcardNumber:function(a){this.bankcardAccount=a.detail.value,this.params.bankcardAccount=parseInt(a.detail.value)},getBranchName:function(){var e=this;return c(n.default.mark((function t(){var r,i,c;return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=a.getStorageSync("token"),e.queryParams,"修改"==e.btn_title?i=e.received_info.bankName:"添加"==e.btn_title&&(i=e.fullNameOfTheBank),t.next=5,e.$request({url:"/iscm/bankBranchList/likeByFullNameOfTheBank?fullNameOfTheBank="+i,method:"GET",header:{Authorization:r}});case 5:c=t.sent,e.branch_list=c.data.rows.map((function(a){return a.fullNameOfTheBank})),e.branch_code_list=c.data.rows.map((function(a){return a.paymentBankNumber})),e.branch_list.unshift("请选择支行联行名称"),"修改"==e.btn_title&&e.bindPickerBranchChange();case 10:case"end":return t.stop()}}),t)})))()},getRemark:function(a){this.remark=a.detail.value,this.params.remark=a.detail.value},formSubmit:function(e){var t=this;return c(n.default.mark((function e(){var r,i,c,s,u,o,l;return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("添加"!=t.btn_title){e.next=22;break}if((null==t.params.carrierBankcardCategory||""==t.params.carrierBankcardCategory||t.params.carrierBankcardCategory.length<1)&&(t.params.carrierBankcardCategory=1),!(null==t.params.carrierAccountType||""==t.params.carrierAccountType||t.params.carrierAccountType<1)){e.next=5;break}return a.showToast({title:"未输入账号类型, 请输入",icon:"none"}),e.abrupt("return");case 5:if(!(null==t.params.bankCode||""==t.params.bankCode||t.params.bankCode.length<1)){e.next=8;break}return a.showToast({title:"未输入银行名称, 请输入",icon:"none"}),e.abrupt("return");case 8:if(!(null==t.params.branchBankName||""==t.params.branchBankName||t.params.branchBankName.length<1)){e.next=11;break}return a.showToast({title:"未输入支行联行, 请输入",icon:"none"}),e.abrupt("return");case 11:if(!(null==t.params.bankcardAccount||""==t.params.bankcardAccount||t.params.bankcardAccount.length<1)){e.next=14;break}return a.showToast({title:"未输入银行卡号, 请输入",icon:"none"}),e.abrupt("return");case 14:return r=a.getStorageSync("token"),i=t.params,e.next=18,t.$request({url:"/app/carrierBankcard/add",method:"POST",data:i,header:{Authorization:r}});case 18:c=e.sent,(c.data.msg="操作成功")?(a.showToast({title:c.data.msg}),setTimeout((function(){a.navigateTo({url:"/pages/bank_card/bank_card"})}),800)):a.showToast({title:c.data.msg,icon:"none"}),e.next=32;break;case 22:if("修改"!=t.btn_title){e.next=32;break}return r=a.getStorageSync("token"),s=t.params,u=t.received_info,o={},Object.assign(o,s,u),e.next=30,t.$request({url:"/app/carrierBankcard/edit",method:"POST",data:o,header:{Authorization:r}});case 30:l=e.sent,(l.data.msg="操作成功")?(a.showToast({title:l.data.msg}),setTimeout((function(){a.navigateTo({url:"/pages/bank_card/bank_card"})}),80)):a.showToast({title:l.data.msg,icon:"none"});case 32:case"end":return e.stop()}}),e)})))()},backBusiness:function(){a.navigateBack({delta:1})}}};e.default=u}).call(this,t("543d")["default"])},8701:function(a,e,t){"use strict";var n=t("de1f"),r=t.n(n);r.a},af03:function(a,e,t){"use strict";t.r(e);var n=t("df0a"),r=t("d627");for(var i in r)"default"!==i&&function(a){t.d(e,a,(function(){return r[a]}))}(i);t("fc8f"),t("8701");var c,s=t("f0c5"),u=Object(s["a"])(r["default"],n["b"],n["c"],!1,null,"0e03401d",null,!1,n["a"],c);e["default"]=u.exports},d627:function(a,e,t){"use strict";t.r(e);var n=t("1d59"),r=t.n(n);for(var i in n)"default"!==i&&function(a){t.d(e,a,(function(){return n[a]}))}(i);e["default"]=r.a},de1f:function(a,e,t){},df0a:function(a,e,t){"use strict";var n;t.d(e,"b",(function(){return r})),t.d(e,"c",(function(){return i})),t.d(e,"a",(function(){return n}));var r=function(){var a=this,e=a.$createElement;a._self._c},i=[]}},[["0ca7","common/runtime","common/vendor"]]]);