(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-11-11"],{2079:function(t,i,e){var a=e("24fb");i=a(!1),i.push([t.i,".page[data-v-0a166909]{width:%?750?%;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.page .buttons[data-v-0a166909]{width:%?600?%}.image[data-v-0a166909]{width:200px;height:200px}",""]),t.exports=i},"23f1":function(t,i,e){var a=e("f215");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var h=e("4f06").default;h("42c37ca7",a,!0,{sourceMap:!1,shadowMode:!1})},2705:function(t,i,e){"use strict";var a=e("cc47"),h=e.n(a);h.a},"4e6c":function(t,i,e){"use strict";e.r(i);var a=e("e486"),h=e.n(a);for(var o in a)"default"!==o&&function(t){e.d(i,t,(function(){return a[t]}))}(o);i["default"]=h.a},ace5:function(t,i,e){"use strict";e.r(i);var a=e("b338"),h=e("4e6c");for(var o in h)"default"!==o&&function(t){e.d(i,t,(function(){return h[t]}))}(o);e("2705");var s,n=e("f0c5"),r=Object(n["a"])(h["default"],a["b"],a["c"],!1,null,"0a166909",null,!1,a["a"],s);i["default"]=r.exports},affb:function(t,i,e){"use strict";e.r(i);var a=e("f45d"),h=e.n(a);for(var o in a)"default"!==o&&function(t){e.d(i,t,(function(){return a[t]}))}(o);i["default"]=h.a},b338:function(t,i,e){"use strict";var a;e.d(i,"b",(function(){return h})),e.d(i,"c",(function(){return o})),e.d(i,"a",(function(){return a}));var h=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("v-uni-view",{staticClass:"page"},[e("v-uni-view",{staticStyle:{height:"80rpx"}}),e("v-uni-navigator",{staticClass:"buttons",attrs:{url:"../camera/camera"}},[e("v-uni-button",{attrs:{type:"primary"}},[t._v("打开自定义相机")])],1),e("v-uni-view",{staticStyle:{height:"60rpx"}}),e("v-uni-navigator",{staticClass:"buttons",attrs:{url:"../camera/idcard/idcard?dotype=face"}},[e("v-uni-button",{attrs:{type:"primary"}},[t._v("打开身份证人像面采集相机")])],1),e("v-uni-view",{staticStyle:{height:"20rpx"}}),e("v-uni-navigator",{staticClass:"buttons",attrs:{url:"../camera/idcard/idcard?dotype=badge"}},[e("v-uni-button",{attrs:{type:"primary"}},[t._v("打开身份证国徽面采集相机")])],1),e("v-uni-view",{staticStyle:{height:"60rpx"}}),e("v-uni-navigator",{staticClass:"buttons",attrs:{url:"../camera/idphoto/idphoto"}},[e("v-uni-button",{attrs:{type:"primary"}},[t._v("打开证件照采集相机")])],1),e("v-uni-view",{staticStyle:{height:"80rpx"}}),e("v-uni-image",{staticClass:"preview",style:{width:t.windowWidth,height:t.windowHeight},attrs:{src:t.imagesrc}}),e("v-uni-view",[t._v("拍摄结果预览图，见下方")]),e("v-uni-image",{staticClass:"preview",staticStyle:{width:"710rpx:height:710rpx",margin:"20rpx"},attrs:{src:t.imagesrc,mode:"aspectFit"}}),e("v-uni-canvas",{staticStyle:{width:"188px",height:"273px",position:"absolute",left:"-500000px",top:"-500000px"},attrs:{id:"canvas-clipper","canvas-id":"canvas-clipper",type:"2d"}}),e("v-uni-image",{staticClass:"image",attrs:{src:t.path}}),e("kps-image-cutter",{attrs:{url:t.url,fixed:!1,maxWidth:500,minHeight:300},on:{ok:function(i){arguments[0]=i=t.$handleEvent(i),t.onok.apply(void 0,arguments)},cancel:function(i){arguments[0]=i=t.$handleEvent(i),t.oncancle.apply(void 0,arguments)}}})],1)},o=[]},c6ba:function(t,i,e){"use strict";var a;e.d(i,"b",(function(){return h})),e.d(i,"c",(function(){return o})),e.d(i,"a",(function(){return a}));var h=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:t.url,expression:"url"}],staticClass:"ksp-image-cutter"},[e("v-uni-canvas",{style:{width:t.target.width+"px",height:t.target.height+"px"},attrs:{"canvas-id":"target"}}),e("v-uni-view",{staticClass:"body"},[t.url?e("v-uni-image",{staticClass:"image",style:{left:t.image.left+"px",top:t.image.top+"px",width:t.image.width+"px",height:t.image.height+"px"},attrs:{src:t.url},on:{load:function(i){arguments[0]=i=t.$handleEvent(i),t.imageLoad.apply(void 0,arguments)}}}):t._e(),t.mask.show?e("v-uni-view",{staticClass:"mask"}):t._e(),e("v-uni-view",{staticClass:"plank",on:{touchstart:function(i){arguments[0]=i=t.$handleEvent(i),t.touchStart(i,"plank")},touchmove:function(i){arguments[0]=i=t.$handleEvent(i),t.touchMove.apply(void 0,arguments)},touchend:function(i){arguments[0]=i=t.$handleEvent(i),t.touchEnd.apply(void 0,arguments)},touchcancel:function(i){arguments[0]=i=t.$handleEvent(i),t.touchCancel.apply(void 0,arguments)}}},[e("v-uni-view",{staticClass:"frame",style:{left:t.frame.left+"px",top:t.frame.top+"px",width:t.frame.width+"px",height:t.frame.height+"px"},on:{touchstart:[function(i){arguments[0]=i=t.$handleEvent(i),t.touchStart(i,"frame")},function(i){i.stopPropagation(),i.preventDefault(),arguments[0]=i=t.$handleEvent(i),t.touchHandle.apply(void 0,arguments)}]}},[t.mask.show?e("v-uni-canvas",{staticClass:"canvas",style:{width:t.frame.width+"px",height:t.frame.height+"px"},attrs:{"canvas-id":"canvas"}}):t._e(),e("v-uni-view",{staticClass:"rect"}),e("v-uni-view",{staticClass:"line-one"}),e("v-uni-view",{staticClass:"line-two"}),e("v-uni-view",{staticClass:"line-three"}),e("v-uni-view",{staticClass:"line-four"}),e("v-uni-view",{staticClass:"frame-left",on:{touchstart:[function(i){arguments[0]=i=t.$handleEvent(i),t.touchStart(i,"left")},function(i){i.stopPropagation(),i.preventDefault(),arguments[0]=i=t.$handleEvent(i),t.touchHandle.apply(void 0,arguments)}]}}),e("v-uni-view",{staticClass:"frame-right",on:{touchstart:[function(i){arguments[0]=i=t.$handleEvent(i),t.touchStart(i,"right")},function(i){i.stopPropagation(),i.preventDefault(),arguments[0]=i=t.$handleEvent(i),t.touchHandle.apply(void 0,arguments)}]}}),e("v-uni-view",{staticClass:"frame-top",on:{touchstart:[function(i){arguments[0]=i=t.$handleEvent(i),t.touchStart(i,"top")},function(i){i.stopPropagation(),i.preventDefault(),arguments[0]=i=t.$handleEvent(i),t.touchHandle.apply(void 0,arguments)}]}}),e("v-uni-view",{staticClass:"frame-bottom",on:{touchstart:[function(i){arguments[0]=i=t.$handleEvent(i),t.touchStart(i,"bottom")},function(i){i.stopPropagation(),i.preventDefault(),arguments[0]=i=t.$handleEvent(i),t.touchHandle.apply(void 0,arguments)}]}}),e("v-uni-view",{staticClass:"frame-left-top",on:{touchstart:[function(i){arguments[0]=i=t.$handleEvent(i),t.touchStart(i,"left-top")},function(i){i.stopPropagation(),i.preventDefault(),arguments[0]=i=t.$handleEvent(i),t.touchHandle.apply(void 0,arguments)}]}}),e("v-uni-view",{staticClass:"frame-left-bottom",on:{touchstart:[function(i){arguments[0]=i=t.$handleEvent(i),t.touchStart(i,"left-bottom")},function(i){i.stopPropagation(),i.preventDefault(),arguments[0]=i=t.$handleEvent(i),t.touchHandle.apply(void 0,arguments)}]}}),e("v-uni-view",{staticClass:"frame-right-top",on:{touchstart:[function(i){arguments[0]=i=t.$handleEvent(i),t.touchStart(i,"right-top")},function(i){i.stopPropagation(),i.preventDefault(),arguments[0]=i=t.$handleEvent(i),t.touchHandle.apply(void 0,arguments)}]}}),e("v-uni-view",{staticClass:"frame-right-bottom",on:{touchstart:[function(i){arguments[0]=i=t.$handleEvent(i),t.touchStart(i,"right-bottom")},function(i){i.stopPropagation(),i.preventDefault(),arguments[0]=i=t.$handleEvent(i),t.touchHandle.apply(void 0,arguments)}]}})],1)],1)],1),e("v-uni-view",{staticClass:"toolbar"},[e("v-uni-button",{staticClass:"btn-cancel",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.oncancle.apply(void 0,arguments)}}},[t._v("返回")]),e("v-uni-button",{staticClass:"btn-ok",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.onok.apply(void 0,arguments)}}},[t._v("确定")])],1)],1)},o=[]},c937:function(t,i,e){"use strict";e.r(i);var a=e("c6ba"),h=e("affb");for(var o in h)"default"!==o&&function(t){e.d(i,t,(function(){return h[t]}))}(o);e("f85c");var s,n=e("f0c5"),r=Object(n["a"])(h["default"],a["b"],a["c"],!1,null,"a3206744",null,!1,a["a"],s);i["default"]=r.exports},cc47:function(t,i,e){var a=e("2079");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var h=e("4f06").default;h("7d3f8f3c",a,!0,{sourceMap:!1,shadowMode:!1})},e486:function(t,i,e){"use strict";var a=e("4ea4");e("e25e"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;e("2e4a");var h=a(e("c937")),o={data:function(){return{windowWidth:"",windowHeight:"",imagesrc:null,imageUrl:"",show:!1,url:"",path:""}},onLoad:function(){this.init()},components:{kpsImageCutter:h.default},methods:{chooseImage:function(){var t=this;uni.chooseImage({success:function(i){t.url=i.tempFilePaths[0]}})},onok:function(t){this.path=t.path,this.url=""},oncancle:function(){this.url=""},setImage:function(t){this.url=t.path},zjzClipper:function(t){var i=this;uni.getImageInfo({src:t.path,success:function(e){console.log(e);var a=uni.createCanvasContext("canvas-clipper",i);a.drawImage(t.path,parseInt(.15*e.width),parseInt(.17*e.height),parseInt(.69*e.width),parseInt(.65*e.height),0,0,188,273),a.draw(!1,(function(){uni.canvasToTempFilePath({destWidth:188,destHeight:273,canvasId:"canvas-clipper",fileType:"jpg",success:function(t){uni.showToast({title:"已保存至相册111",duration:2e3})}})}))}})},savePhoto:function(t){this.imagesrc=t,uni.saveImageToPhotosAlbum({filePath:t,success:function(){uni.showToast({title:"已保存至相册了",duration:2e3})}})},init:function(){var t=this;uni.getSystemInfo({success:function(i){t.windowWidth=i.windowWidth,t.windowHeight=i.windowHeight}})}}};i.default=o},f215:function(t,i,e){var a=e("24fb");i=a(!1),i.push([t.i,".ksp-image-cutter[data-v-a3206744]{position:absolute;width:100%;height:100%;top:0;bottom:0;z-index:1000}.toolbar[data-v-a3206744]{position:absolute;width:100%;height:%?100?%;left:%?0?%;bottom:%?0?%;box-sizing:border-box;border-bottom:1px solid silver;background:#f8f8f8}.btn-cancel[data-v-a3206744]{position:absolute;left:%?100?%;top:%?12?%;font-size:%?30?%;line-height:%?30?%;padding:%?20?%;color:#333}.btn-ok[data-v-a3206744]{position:absolute;right:%?100?%;top:%?12?%;font-size:%?30?%;line-height:%?30?%;padding:%?20?%;color:#333}.body[data-v-a3206744]{position:absolute;left:%?0?%;right:%?0?%;top:%?0?%;bottom:%?100?%;background:#000;overflow:hidden}.mask[data-v-a3206744]{position:absolute;left:%?0?%;right:%?0?%;top:%?0?%;bottom:%?0?%;background:#000;opacity:.4}.plank[data-v-a3206744]{position:absolute;left:%?0?%;right:%?0?%;top:%?0?%;bottom:%?0?%}.image[data-v-a3206744]{position:absolute}.frame[data-v-a3206744]{position:absolute}.canvas[data-v-a3206744]{position:absolute;display:block;left:0;top:0}.rect[data-v-a3206744]{position:absolute;left:-2px;top:-2px;width:100%;height:100%;border:2px solid #fff}.line-one[data-v-a3206744]{position:absolute;width:100%;height:1px;background:#fff;left:0;top:33.3%}.line-two[data-v-a3206744]{position:absolute;width:100%;height:1px;background:#fff;left:0;top:66.7%}.line-three[data-v-a3206744]{position:absolute;width:1px;height:100%;background:#fff;top:0;left:33.3%}.line-four[data-v-a3206744]{position:absolute;width:1px;height:100%;background:#fff;top:0;left:66.7%}.frame-left[data-v-a3206744]{position:absolute;height:100%;width:8px;left:-4px;top:0}.frame-right[data-v-a3206744]{position:absolute;height:100%;width:8px;right:-4px;top:0}.frame-top[data-v-a3206744]{position:absolute;width:100%;height:8px;top:-4px;left:0}.frame-bottom[data-v-a3206744]{position:absolute;width:100%;height:8px;bottom:-4px;left:0}.frame-left-top[data-v-a3206744]{position:absolute;width:20px;height:20px;left:-6px;top:-6px;border-left:4px solid red;border-top:4px solid red}.frame-left-bottom[data-v-a3206744]{position:absolute;width:20px;height:20px;left:-6px;bottom:-6px;border-left:4px solid red;border-bottom:4px solid red}.frame-right-top[data-v-a3206744]{position:absolute;width:20px;height:20px;right:-6px;top:-6px;border-right:4px solid red;border-top:4px solid red}.frame-right-bottom[data-v-a3206744]{position:absolute;width:20px;height:20px;right:-6px;bottom:-6px;border-right:4px solid red;border-bottom:4px solid red}",""]),t.exports=i},f45d:function(t,i,e){"use strict";e("ace4"),e("a9e3"),e("d3b7"),e("ac1f"),e("3ca3"),e("466d"),e("1276"),e("5cc6"),e("9a8c"),e("a975"),e("735e"),e("c1ac"),e("d139"),e("3a7b"),e("d5d6"),e("82f8"),e("e91f"),e("60bd"),e("5f96"),e("3280"),e("3fcc"),e("ca91"),e("25a1"),e("cd26"),e("3c5d"),e("2954"),e("649e"),e("219c"),e("170b"),e("b39a"),e("72f7"),e("ddb0"),e("2b3d"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a={props:{url:{type:String,default:""},fixed:{type:Boolean,default:!1},width:{type:Number,default:200},height:{type:Number,default:200},maxWidth:{type:Number,default:1024},maxHeight:{type:Number,default:1024},blob:{type:Boolean,default:!0}},data:function(){return{mask:{show:!1},frame:{left:50,top:50,width:this.width,height:this.height},image:{left:20,top:20,width:300,height:400},real:{width:100,height:100},target:{width:this.width,height:this.height},touches:[],type:"",start:{frame:{left:0,top:0,width:0,height:0},image:{left:0,top:0,width:0,height:0}},timeoutId:-1,context:null}},mounted:function(){this.$el.addEventListener("touchmove",(function(t){t.preventDefault()})),this.context=uni.createCanvasContext("canvas",this),this.targetContext=uni.createCanvasContext("target",this)},methods:{imageLoad:function(t){var i=this;this.mask.show=!0,this.real.width=t.detail.width,this.real.height=t.detail.height,this.image.width=t.detail.width,this.image.height=t.detail.height,this.frame.width=this.width,this.frame.height=this.height,this.fixed||(this.frame.width=this.image.width,this.frame.height=this.image.height);var e=uni.createSelectorQuery().in(this);e.select(".body").boundingClientRect((function(t){var e=t.width,a=t.height,h=i.frame.width,o=i.frame.height,s=.8*e,n=.8*a,r=s/h,l=n/o,c=r;r<l&&(c=l),s=h*c,n=o*c;var f=(e-s)/2,u=(a-n)/2;i.frame.width=s,i.frame.height=n,i.frame.left=f,i.frame.top=u;var d=i.image.width,p=i.image.height;r=s/d,l=n/p,c=r,r<l&&(c=l),i.image.width=d*c,i.image.height=p*c,i.image.left=(e-i.image.width)/2,i.image.top=(a-i.image.height)/2,setTimeout((function(){i.trimImage()}),100)})).exec()},touchHandle:function(){},touchStart:function(t,i){this.stopTime(),this.mask.show=!1,0==this.touches.length&&(this.type=i,this.start.frame.left=this.frame.left,this.start.frame.top=this.frame.top,this.start.frame.width=this.frame.width,this.start.frame.height=this.frame.height,this.start.image.left=this.image.left,this.start.image.top=this.image.top,this.start.image.width=this.image.width,this.start.image.height=this.image.height);for(var e=t.changedTouches,a=0;a<e.length;a++){var h=e[a];this.touches.push(h)}},touchMove:function(t){this.stopTime(),t.preventDefault();var i=t.touches;if(1==this.touches.length)"plank"==this.type||"frame"==this.type||this.fixed?this.moveImage(this.touches[0],i[0]):this.scaleFrame(this.touches[0],i[0],this.type);else if(2==this.touches.length&&2==i.length){var e=this.touches[0],a=this.touches[1],h=i[0],o=i[1];if(e.identifier!=h.identifier){var s=h;h=o,o=s}this.scaleImage(e,a,h,o)}},touchEnd:function(t){this.type="",this.touches=[],this.startTime()},touchCancel:function(t){this.type="",this.touches=[],this.startTime()},startTime:function(){var t=this;this.stopTime(),this.timeoutId=setTimeout((function(){t.trimImage()}),800)},stopTime:function(){this.timeoutId>=0&&(clearTimeout(this.timeoutId),this.timeoutId=-1)},trimImage:function(){var t=this;this.mask.show=!0;var i=uni.createSelectorQuery().in(this);i.select(".body").boundingClientRect((function(i){var e=i.width,a=i.height,h=t.frame.width,o=t.frame.height,s=.8*e,n=.8*a,r=s/h,l=n/o,c=r;r>l&&(c=l),s=h*c,n=o*c;var f=(e-s)/2,u=(a-n)/2,d=f-t.frame.left+(t.frame.left-t.image.left)*(1-c),p=u-t.frame.top+(t.frame.top-t.image.top)*(1-c);t.frame.width=s,t.frame.height=n,t.frame.left=f,t.frame.top=u,t.image.width*=c,t.image.height*=c,t.image.left+=d,t.image.top+=p})).exec(),setTimeout((function(){var i=t.image.width/t.real.width,e=(t.frame.left-t.image.left)/i,a=(t.frame.top-t.image.top)/i,h=t.frame.width/i,o=t.frame.height/i;t.context.drawImage(t.url,e,a,h,o,0,0,t.frame.width,t.frame.height),t.context.draw(!1)}),100)},moveImage:function(t,i){var e=i.clientX-t.clientX,a=i.clientY-t.clientY;this.image.left=this.start.image.left+e,this.image.top=this.start.image.top+a,this.image.left>this.frame.left&&(this.image.left=this.frame.left),this.image.top>this.frame.top&&(this.image.top=this.frame.top),this.image.left+this.image.width<this.frame.left+this.frame.width&&(this.image.left=this.frame.left+this.frame.width-this.image.width),this.image.top+this.image.height<this.frame.top+this.frame.height&&(this.image.top=this.frame.top+this.frame.height-this.image.height)},scaleImage:function(t,i,e,a){var h=t.clientX,o=t.clientY,s=i.clientX,n=i.clientY,r=e.clientX,l=e.clientY,c=a.clientX,f=a.clientY,u=Math.sqrt((h-s)*(h-s)+(o-n)*(o-n)),d=Math.sqrt((r-c)*(r-c)+(l-f)*(l-f)),p=(h+s)/2,m=(o+n)/2,g=(r+c)/2,v=(l+f)/2,w=g-p,b=v-m,x=d/u;this.start.image.width*x<this.frame.width&&(x=this.frame.width/this.start.image.width),this.start.image.height*x<this.frame.height&&(x=this.frame.height/this.start.image.height),this.start.image.width*x<this.frame.width&&(x=this.frame.width/this.start.image.width),this.image.left=this.start.image.left+w-(p-this.start.image.left)*(x-1),this.image.top=this.start.image.top+b-(m-this.start.image.top)*(x-1),this.image.width=this.start.image.width*x,this.image.height=this.start.image.height*x,this.image.left>this.frame.left&&(this.image.left=this.frame.left),this.image.top>this.frame.top&&(this.image.top=this.frame.top),this.image.left+this.image.width<this.frame.left+this.frame.width&&(this.image.left=this.frame.left+this.frame.width-this.image.width),this.image.top+this.image.height<this.frame.top+this.frame.height&&(this.image.top=this.frame.top+this.frame.height-this.image.height)},scaleFrame:function(t,i,e){var a=i.clientX-t.clientX,h=i.clientY-t.clientY,o=this.start.frame.left,s=this.start.frame.top,n=this.start.frame.left+this.start.frame.width,r=this.start.frame.top+this.start.frame.height;"left"==e?o+=a:"right"==e?n+=a:"top"==e?s+=h:"bottom"==e?r+=h:"left-top"==e?(o+=a,s+=h):"left-bottom"==e?(o+=a,r+=h):"right-top"==e?(n+=a,s+=h):"right-bottom"==e&&(n+=a,r+=h),o<this.image.left&&(o=this.image.left),s<this.image.top&&(s=this.image.top),n>this.image.left+this.image.width&&(n=this.image.left+this.image.width),r>this.image.top+this.image.height&&(r=this.image.top+this.image.height),this.frame.left=o,this.frame.top=s,this.frame.width=n-o,this.frame.height=r-s},parseBlob:function(t){for(var i=t.split(","),e=i[0].match(/:(.*?);/)[1],a=atob(i[1]),h=a.length,o=new Uint8Array(h),s=0;s<h;s++)o[s]=a.charCodeAt(s);var n=URL||webkitURL;return n.createObjectURL(new Blob([o],{type:e}))},onok:function(){var t=this,i=this.image.width/this.real.width,e=(this.frame.left-this.image.left)/i,a=(this.frame.top-this.image.top)/i,h=this.frame.width/i,o=this.frame.height/i,s=h,n=o;if(this.fixed)s=this.width/2,n=this.height/2;else{if(s>this.maxWidth/2){var r=this.maxWidth/2/s;s*=r,n*=r}if(n>this.maxHeight/2){r=this.maxHeight/2/n;n*=r,s*=r}}this.target.width=s,this.target.height=n,uni.showLoading({title:"正在裁剪"}),setTimeout((function(){t.targetContext.drawImage(t.url,e,a,h,o,0,0,s,n),t.targetContext.draw(!1,(function(){uni.canvasToTempFilePath({canvasId:"target",success:function(i){var e=i.tempFilePath;t.blob&&(e=t.parseBlob(e)),t.$emit("ok",{path:e})},fail:function(t){console.log(t)},complete:function(){uni.hideLoading()}},t)}))}),100)},oncancle:function(){this.$emit("cancel")}}};i.default=a},f85c:function(t,i,e){"use strict";var a=e("23f1"),h=e.n(a);h.a}}]);