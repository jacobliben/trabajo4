(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/company_license/company_license"],{"0915":function(e,t,i){"use strict";i.r(t);var r=i("b7fb"),a=i("f48c");for(var n in a)"default"!==n&&function(e){i.d(t,e,(function(){return a[e]}))}(n);i("a959");var s,c=i("f0c5"),o=Object(c["a"])(a["default"],r["b"],r["c"],!1,null,"0031d13c",null,!1,r["a"],s);t["default"]=o.exports},"6acc":function(e,t,i){},a00c:function(e,t,i){"use strict";(function(e){i("c5c7");r(i("66fd"));var t=r(i("0915"));function r(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,i("543d")["createPage"])},a959:function(e,t,i){"use strict";var r=i("6acc"),a=i.n(r);a.a},b7fb:function(e,t,i){"use strict";var r;i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return n})),i.d(t,"a",(function(){return r}));var a=function(){var e=this,t=e.$createElement;e._self._c;e._isMounted||(e.e0=function(t){e.begin_date_has_input=!0},e.e1=function(t){e.expiry_date_has_input=!0},e.e2=function(t){e.driver_cert_expiry_date_has_input=!0})},n=[]},dba5:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(i("a34a")),a=i("2e4a");function n(e){return e&&e.__esModule?e:{default:e}}function s(e,t,i,r,a,n,s){try{var c=e[n](s),o=c.value}catch(d){return void i(d)}c.done?t(o):Promise.resolve(o).then(r,a)}function c(e){return function(){var t=this,i=arguments;return new Promise((function(r,a){var n=e.apply(t,i);function c(e){s(n,r,a,c,o,"next",e)}function o(e){s(n,r,a,c,o,"throw",e)}c(void 0)}))}}var o,d=function(){i.e("components/xfl-select/xfl-select").then(function(){return resolve(i("00e2"))}.bind(null,i)).catch(i.oe)},l=i("6802"),u={data:function(){var e=this.getDate({format:!0});return{isPerson:!1,disabled:!0,active:!1,active_two_step:!1,active_three_step:!1,driver_name:"",driver_id:"",driver_tel:"",quali_cert_num:"",imgDriverIDFrontUrl:"/static/id_front.jpg",imgDriverIDBackUrl:"/static/id-back.jpg",imgDriverLicensePhotoUrl:"/static/driving_license.jpg",imgDrivingCertificateUrl:"/static/roadcert.jpg",tachar_driver_id_front:!1,tachar_driver_id_back:!1,tachar_driver_license:!1,tachar_driving_certificate:!1,begin_date:e,expiry_date:e,driver_cert_expiry_date:e,list:["A2","B2"],index:0,begin_date_has_input:!1,expiry_date_has_input:!1,driver_cert_expiry_date_has_input:!1,params:{active_one_step:!0,active_two_step:!0,active_three_step:!0,active_four_step:!0,the_step:4}}},components:{xflSelect:d},computed:{endDate:function(){return this.getDate("end")}},created:function(){this.isPerson=e.getStorageSync("in_personal_registering"),this.params_license=e.getStorageSync("params_license")},mounted:function(){var t=this.params_license.driverVehicleClass||"A2";this.index=this.list.findIndex((function(e){return e==t})),this.isPerson&&(this.quali_cert_num=e.getStorageSync("driver_id_num")),this.isPerson||(this.quali_cert_num=this.params_license.driverIdNumber||"",this.quali_cert_num=this.params_license.qualificationCertNo||""),this.params_license.qualificationCertStartDate&&(this.begin_date=this.params_license.qualificationCertStartDate||this.getDate({format:!0}),this.begin_date_has_input=!0),this.params_license.qualificationCertExpireDate&&(this.expiry_date=this.params_license.qualificationCertExpireDate||this.getDate({format:!0}),this.expiry_date_has_input=!0),this.params_license.drivercertValidPeriodTo&&(this.driver_cert_expiry_date=this.params_license.drivercertValidPeriodTo||this.getDate({format:!0}),this.driver_cert_expiry_date_has_input=!0),this.isPerson||(this.driver_name=this.params_license.driverName,this.driver_id=this.params_license.driverIdNumber,this.driver_tel=this.params_license.driverPhone),this.params=this.params_license||{},this.params_license.drivingLicensePhotoFirst&&(this.disabled=!1,this.active=!0)},methods:{detailImage:function(e,t){plus.io.resolveLocalFileSystemURL(e,(function(e){e.file((function(e){var i=new plus.io.FileReader;i.readAsDataURL(e),i.onloadend=function(e){t(e.target.result)}}))}))},bindPickerChange:function(e){console.log("picker发送选择改变，携带值为 准驾车型",e.target.value),this.index=e.target.value,0==this.index?this.params.driverVehicleClass="A2":1==this.index&&(this.params.driverVehicleClass="B2")},getDriverName:function(e){this.driver_name=e.detail.value,this.params.driverName=e.detail.value,this.params.driverCertificateType="201"},getDriverApprovedVehicleType:function(e){this.params.driverVehicleClass=e.newVal},getDriverCel:function(e){this.driver_tel=e.detail.value,this.params.driverPhone=e.detail.value},getDriverID:function(e){this.driver_id=e.detail.value,this.params.driverIdNumber=e.detail.value,this.isPerson||(this.quali_cert_num=e.detail.value,this.params.qualificationCertNo=e.detail.value)},getDrivingCertificateNum:function(e){this.quali_cert_num=e.detail.value,this.params.qualificationCertNo=e.detail.value},bindDateChange:function(e){"license_begin_date"==e.currentTarget.dataset.index?(this.begin_date=e.target.value,this.params.qualificationCertStartDate=this.begin_date,this.begin_date_has_input=!0):"license_expiry_date"==e.currentTarget.dataset.index?(this.expiry_date=e.target.value,this.params.qualificationCertExpireDate=this.expiry_date,this.expiry_date_has_input=!0):"driver_cert_expiry_date"==e.currentTarget.dataset.index&&(this.driver_cert_expiry_date=e.target.value,this.params.drivercertValidPeriodTo=e.target.value,this.driver_cert_expiry_date_has_input=!0)},getDate:function(e){var t=new Date,i=t.getFullYear(),r=t.getMonth()+1,a=t.getDate();return"start"===e?i-=60:"end"===e&&(i+=20),r=r>9?r:"0"+r,a=a>9?a:"0"+a,"".concat(i,"-").concat(r,"-").concat(a)},takephoto:function(t){var i=this;return c(r.default.mark((function n(){return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(o=i,"driver_id_front"!=t.currentTarget.dataset.index){n.next=5;break}e.chooseImage({count:1,sizeType:["original","compressed"],success:function(e){return c(r.default.mark((function t(){var i;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=e.tempFilePaths,console.log(i,"876"),o.imgDriverIDFrontUrl=i[0],o.tachar_driver_id_front=!0,t.next=6,o.$upload({url:a.ossLocation.driver.front,file_path:i[0]});case 6:t.sent;case 7:case"end":return t.stop()}}),t)})))()},error:function(e){console.log(e)}}),n.next=21;break;case 5:if("driver_id_back"!=t.currentTarget.dataset.index){n.next=9;break}e.chooseImage({count:1,sizeType:["original","compressed"],success:function(e){return c(r.default.mark((function t(){var i;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=e.tempFilePaths,console.log(i,"876"),o.imgDriverIDBackUrl=i[0],o.tachar_driver_id_back=!0,t.next=6,o.$upload({url:a.ossLocation.driver.reverse,file_path:i[0]});case 6:t.sent;case 7:case"end":return t.stop()}}),t)})))()},error:function(e){console.log(e)}}),n.next=21;break;case 9:if("driver_license_photo_first"!=t.currentTarget.dataset.index){n.next=17;break}return o.disabled=!1,o.active=!0,n.next=14,i.$photo({success:function(e){return c(r.default.mark((function t(){var i;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=e.tempFilePaths,o.imgDriverLicensePhotoUrl=i[0],o.tachar_driver_license=!0,t.next=5,o.$upload({url:a.ossLocation.driver.first,file_path:i[0]});case 5:t.sent;case 6:case"end":return t.stop()}}),t)})))()}});case 14:n.sent,n.next=21;break;case 17:if("driving_certificate"!=t.currentTarget.dataset.index){n.next=21;break}return n.next=20,i.$photo({success:function(e){return c(r.default.mark((function t(){var i;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=e.tempFilePaths,o.imgDrivingCertificateUrl=i[0],o.tachar_driving_certificate=!0,t.next=5,o.$upload({url:a.ossLocation.driver.cert,file_path:i[0]});case 5:t.sent;case 6:case"end":return t.stop()}}),t)})))()}});case 20:n.sent;case 21:case"end":return n.stop()}}),n)})))()},cancelDriverIDFront:function(){this.imgDriverIDFrontUrl="/static/id_front.jpg",setTimeout((function(){e.showToast({title:"删除照片成功，请重新选择",icon:"none"})}),500),this.tachar_driver_id_front=!1},cancelDriverIDBack:function(){this.imgDriverIDBackUrl="/static/id-back.jpg",setTimeout((function(){e.showToast({title:"删除照片成功，请重新选择",icon:"none"})}),500),this.tachar_driver_id_back=!1},cancelDriverLicense:function(){this.imgDriverLicensePhotoUrl="/static/driving_license.jpg",setTimeout((function(){e.showToast({title:"删除照片成功，请重新选择",icon:"none"})}),500),this.tachar_driver_license=!1},cancelDrivingCertificate:function(){this.imgDrivingCertificateUrl="/static/roadcert.jpg",setTimeout((function(){e.showToast({title:"删除照片成功，请重新选择",icon:"none"})}),500),this.tachar_driving_certificate=!1},backVehicle:function(){this.params.the_step=3,this.params.active_one_step=!0,this.params.active_two_step=!0,this.params.active_three_step=!0,this.params.active_four_step=!1,this.params.active_five_step=!1,e.setStorageSync("params_license",this.params),this.$emit("register_license_params",this.params)},formSubmit:function(t){if(this.params.drivingLicensePhotoFirst=e.getStorageSync("drivingLicensePhotoFirst"),null==this.params.drivingLicensePhotoFirst||""==this.params.drivingLicensePhotoFirst||this.params.drivingLicensePhotoFirst.length<1)e.showToast({title:"未提交机动车驾驶证主页, 请提交",icon:"none"});else{if(!this.isPerson){if(this.params.idcardFront=e.getStorageSync("idcardFront"),null==this.params.idcardFront||""==this.params.idcardFront||this.params.idcardFront.length<1)return void e.showToast({title:"未提交驾驶员身份证正面, 请提交",icon:"none"});if(this.params.idcardBack=e.getStorageSync("idcardBack"),null==this.params.idcardBack||""==this.params.idcardBack||this.params.idcardBack.length<1)return void e.showToast({title:"未提交驾驶员身份证背面, 请提交",icon:"none"});if(null==this.params.driverName||""==this.params.driverName||this.params.driverName.length<1)return void e.showToast({title:"未输入驾驶员姓名号码, 请输入",icon:"none"});if(null==this.params.driverIdNumber||""==this.params.driverIdNumber||this.params.driverIdNumber.length<18)return void e.showToast({title:"驾驶员身份证号不正确, 请重输",icon:"none"});if(null==this.params.driverPhone||""==this.params.driverPhone||this.params.driverPhone.length<11)return void e.showToast({title:"驾驶员手机号码不正确, 请修改",icon:"none"})}(null==this.params.driverVehicleClass||""==this.params.driverVehicleClass||this.params.driverVehicleClass.length<1)&&(this.params.driverVehicleClass="A2"),console.log("form发生了submit事件，携带数据为："+JSON.stringify(t.detail.value));var i=[{name:"cellphone",checkType:"phoneno",errorMsg:"手机号格式不正确"}],r=t.detail.value,a=l.check(r,i);a||this.isPerson?(this.params.the_step=5,this.params.active_one_step=!0,this.params.active_two_step=!0,this.params.active_three_step=!0,this.params.active_four_step=!0,this.params.active_five_step=!0,e.setStorageSync("params_license",this.params),this.$emit("register_license_params",this.params)):(e.showToast({title:l.error,icon:"none"}),this.driver_tel="")}}}};t.default=u}).call(this,i("543d")["default"])},f48c:function(e,t,i){"use strict";i.r(t);var r=i("dba5"),a=i.n(r);for(var n in r)"default"!==n&&function(e){i.d(t,e,(function(){return r[e]}))}(n);t["default"]=a.a}},[["a00c","common/runtime","common/vendor"]]]);